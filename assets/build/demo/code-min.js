KISSY.add("demo/code",function(s,e,t,o,c){var m=s.all,i=new t,d=function(){this.el=m("#J_Code"),this.commitEl=m("#J_Commit"),this.updateEl=m("#J_Update"),this.events={"click #J_Back":"goBack","click #J_Commit":"commit","click #J_Update":"update","click #J_Debug":"debug"},this.iframe=m("#J_Result")[0].contentWindow.document,this.init()};return s.extend(d,e),d.prototype.init=function(){this.resetColumns(),this.createEditor(),d.superclass.constructor.call(this)},d.prototype.render=function(s){var e=this;s?(e.commitEl.hide(),e.updateEl.show()):(e.commitEl.show(),e.updateEl.hide()),i.render(s),e.setEditorVal(s||{})},d.prototype.goBack=function(){var s=this;s._render("list")},d.prototype.update=function(s){var e=this;e._ajax(s,"./act/edit.php",e.makeDemoInfo("update"))},d.prototype.commit=function(s){var e=this;e._ajax(s,"./act/add.php",e.makeDemoInfo("commit"))},d.prototype.debug=function(){var s=this,e=s.getDebugCode(s.getEditorVal());s.iframe.open(),s.iframe.write(e),s.iframe.close()},d.prototype.resetColumns=function(){var s=m("#J_Cont"),e=m(".column",s);e.width((s.width()-250)/2)},d.prototype.createEditor=function(){var s=this,e=function(s,e){var s=ace.edit(s[0]);return s.setTheme("ace/theme/dreamweaver"),s.getSession().setMode("ace/mode/"+e),s};s.htmlEditor=e(m("#J_HtmlWin"),"html"),s.cssEditor=e(m("#J_CssWin"),"css"),s.jsEditor=e(m("#J_JsWin"),"javascript")},d.prototype.setEditorVal=function(s){var e=this;e.htmlEditor.setValue(s.html),e.htmlEditor.focus(),e.htmlEditor.clearSelection(),e.cssEditor.setValue(s.css),e.cssEditor.focus(),e.cssEditor.clearSelection(),e.jsEditor.setValue(s.js),e.jsEditor.focus(),e.jsEditor.clearSelection(),e.debug()},d.prototype.getEditorVal=function(){var s=this;return{html:s.htmlEditor.getValue(),css:s.cssEditor.getValue(),js:s.jsEditor.getValue()}},d.prototype.getDebugCode=function(s){var e=["<!DOCTYPE html>\r\n","<html>\r\n","<head>\r\n",'<meta charset="utf-8" />\r\n',"<title>{{module}}</title>\r\n","<style>\r\n","{{css}}\r\n","</style>\r\n","</head>\r\n","<body>\r\n","{{{html}}}\r\n",'<script src="http://a.tbcdn.cn/s/kissy/1.3.0/seed-min.js" data-config="{combine:true}"></script>\r\n',"<script>\r\n","{{js}}\r\n","</script>\r\n","</body>\r\n","</html>"].join("");return new c(e).render(s)},d.prototype.makeDemoInfo=function(e){var t=this,o=t.getEditorVal(),c=i.getDemoConfig();switch(e){case"update":return s.merge(o,c,{id:t._get("id")});default:return s.merge(o,c)}},d},{requires:["demo/base","demo/config","node","xtemplate"]});